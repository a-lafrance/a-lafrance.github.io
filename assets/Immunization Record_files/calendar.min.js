/*! Copyright (c) Epic Systems Corporation 2014 - 2016 */
$$WPUtil.guaranteeExistence($$WP,"Components");$$WP.Components.Calendar=function $$WPCal(b){var c=true,n="PrevButton",m="NextButton",l="HoverTextDisabled",k="HoverText",d="Global.Calendar",j="undefined",a=this;if(typeof $$WP!==j&&typeof $$WP.Strings!==j){$$WP.Strings.setDefaultNamespace(d);$$WP.Strings.add("CalendarMonthTitleFormat","Jan");$$WP.Strings.add("CalendarAudibleDate","_STR_AudibleDate_");$$WP.Strings.add(k,"_STR_SelectTooltip_");$$WP.Strings.add(l,"_STR_NotAvailableTooltip_");$$WP.Strings.add(m,"");$$WP.Strings.add(n,"");$$WP.Strings.add("CalendarNextandPrevTitles","Show @MYCHART@DATEWITHMONTH@");$$WP.Strings.clearDefaultNamespace()}a.onSelect=b.onSelect||function(){};a.TitleText=b.TitleText||"";a.Image=b.Image||"";a.filter=b.filter||function(){return c};a.FromDTE=b.FromDTE;a.ToDTE=b.ToDTE;a.callback=b.callback||function(){};a.SelectedDate=b.SelectedDate;a.HighlightDays=b.HighlightDays||[];a.HasSelectableDays=b.HasSelectableDays===c;a._calendarMouseover=b._calendarMouseover||a._calendarMouseover;a.IsClickEventEnabled=b.IsClickEventEnabled||c;a.IsNextEnabled=b.IsNextEnabled||false;a.IsPrevEnabled=b.IsPrevEnabled||false;for(var f,h,i,o,g=0;g<a.HighlightDays.length;g++)if(a.HighlightDays[g].length>0){f=new Date(a.HighlightDays[g]);h=f.getMonth()+1;o=f.getDate();i=f.getFullYear();a.Dict[h+"/"+o+"/"+i]=c;a.SelectableMonths[h+"/"+i]=c}if(!$$WP.Utilities.IsNullOrEmpty(a.SelectedDate))if(typeof a.SelectedDate.getYear==="function")a.Today=a.SelectedDate;else if(typeof a.SelectedDate.getYear==="string")a.Today=new Date(a.SelectedDate);else a.Today=new Date;else a.Today=new Date;a.Month=a.Today.getMonth();a.Year=a.Today.getFullYear();a.PrevButton=$$WP.Strings.get(n,d);a.NextButton=$$WP.Strings.get(m,d);a.HoverText=$$WP.Strings.get(k,d);a.HoverTextDisabled=$$WP.Strings.get(l,d);for(var e=0;e<7;e++)a.Days[e]='<span class="clearlabel">'+getDayName((e+getFirstDayOfWeek())%7)+"</span>"+getDayLetter((e+getFirstDayOfWeek())%7);a.formatCalendarDate=buildFormat('<\\span cla\\s\\s="clearlabel">dddd, MMMM </\\span><\\span>d</\\span><\\span cla\\s\\s="clearlabel">, yyyy</\\span>');a.formatCalendarTitle=buildFormat("MMMM yyyy");a.Components$TemplateComponent(b);a.addEventListener("click",a._calendarClick);a.addEventListener("focus",a._calendarFocus)};$$WP.Components.Calendar.prototype={Today:{},Title:"",Image:"",Summary:"",Class:"calendar",filter:"",FromDTE:"",ToDTE:"",Callback:"",SelectedDate:"",HoverText:"",HoverTextDisabled:"",Month:"",Year:"",Days:[],PrevButton:"",NextButton:"",HighlightDays:[],HasSelectableDays:"",Dict:{},SelectableMonths:{},data:{},formatCalendarDate:"",IsClickEventEnabled:true,IsNextEnabled:false,IsPrevEnabled:false,formatCalendarTitle:"",template:$$WP.Templates.calendar,setData:function $$WP$Components$Calendar$set(){this.setTitles();this.Components$TemplateComponent$setData(this.Data)},setTitles:function $$WP$Components$Calendar$title(){var e="CalendarNextandPrevTitles",b="@MYCHART@DATEWITHMONTH@",a=this,i,m,g,j,l,h,f,k,c=a.Month,d=a.Year;k=!a.hasSelectableDay(c,d);j=a.formatCalendarTitle(makeDate(d,c+1));$$WP.Strings.setDefaultNamespace("Global.Calendar");$$WP.Strings.addMnemonic(b,a.formatCalendarTitle(makeDate(d,c)));i=$$WP.Strings.get(e);$$WP.Strings.removeMnemonic(b);$$WP.Strings.addMnemonic(b,a.formatCalendarTitle(makeDate(d,c+2)));h=$$WP.Strings.get(e);$$WP.Strings.removeMnemonic(b);$$WP.Strings.clearDefaultNamespace();g=a.IsPrevEnabled;f=a.IsNextEnabled;a.Data={PrevClass:m,PrevButton:a.PrevButton,IsPrevEnabled:g,Title:j,PrevTitle:i,NextTitle:h,NextClass:l,NextButton:a.NextButton,IsNextEnabled:f,Days:a.Days,ComponentNumber:a.ComponentNumber}},reInit:function $$WP$Components$Calendar$refresh(a){var b,e,f,d;if(a.HighlightDays)for(var c=0;c<a.HighlightDays.length;c++)if(a.HighlightDays[c].length>0){b=new Date(a.HighlightDays[c]);e=b.getMonth()+1;d=b.getDate();f=b.getFullYear();this.Dict[e+"/"+d+"/"+f]=true}this.setData();this.refresh()},html:function(a){this.Components$Component$html(a);this.$content.find(".hasevents").safeAttr("data-id","hasevents")},_calendarClick:function $$WP$Components$Calendar$_click(a){if(this.IsClickEventEnabled){if(a.dataId==="calnext"){this.drawNextMonth();WP.Events.cancelEvent(a);WP.Events.preventDefault(a)}if(a.dataId==="calprev"){this.drawPreviousMonth();WP.Events.cancelEvent(a);WP.Events.preventDefault(a)}}},_calendarFocus:function $$WP$Components$Calendar$_focus(a,b){this.$$WP$Components$Calendar$_mouseover(a,b)},_isInCalendar:function $$WP$Components$Calendar$_isInCalendar(c){var b,a;for(a=c,b=0;a&&b<6;a=a.parentNode,b++)if(a&&a.id&&a.id.toLowerCase()==="calendar")return true;return false},setClickFunction:function $$WP$Components$Calendar$setClickFunction(l){var d=this;for(var j=d.hoverText,i=d.hoverTextDisabled,m=d.clickFunction,h=l.getElementsByTagName("td"),a,b,f=new Date,k=document.all?"hand":"pointer",e=function(a,c){var b="mouseover";WP.Events.addListener(a,"click",m);if(a.className==="ctrl"){WP.Events.addListener(a,b,hi());WP.Events.addListener(a,"mouseout",lo);WP.Events.addListener(a.firstChild,"focus",hi(true));WP.Events.addListener(a.firstChild,"blur",lo)}else{WP.Events.addListener(a,b,function(){a.firstChild.focus()});WP.Events.addListener(a.firstChild,"focus",hi())}a.style.cursor=k;if(c!==true)a.title=j},c=function(a){a.style.cursor="default";a.title=i},g=0;g<h.length;++g){a=h[g];b=a.className;if(b==="null"||b==="hdr"||!a.firstChild)continue;if(b==="ctrl")e(a,true);else if(b.indexOf("othermonth")>0)c(a);else if(b.indexOf("n")===0)c(a);else if(b.indexOf("wkndn")===0)c(a);else if(b==="ctrln")c(a);else if(b!=="today")e(a);else if(d.filter(f.getFullYear(),f.getMonth(),f.getDate()))e(a);else c(a)}},drawNextMonth:function $$WP$Components$Calendar$drawNextMonth(){var a=this;a.Month=(a.Month+1)%12;if(a.Month===0)a.Year++;a.set()},drawPreviousMonth:function $$WP$Components$Calendar$drawPreviousMonth(){var a=this;a.Month=a.Month-1;if(a.Month<0)a.Month+=12;if(a.Month===11)a.Year--;a.getCalendarObject();a.set()},hasSelectableDay:function $$WP$Components$Calendar$hasSelectableDay(b,d){var c=1,a=makeDate(d,b+1,c);b=a.getMonth();while(a.getMonth()===b){if(this.filter(a.getFullYear(),a.getMonth(),c))return true;a.setDate(++c)}return false},getCalendarObject:function $$WP$Components$Calendar$getCalendarObject(){var b=this,m=document.createElement("tbody"),k,f=b.Month,i=b.Year,a,e=new Date,s=e.getDate(),p=e.getMonth(),q=e.getFullYear(),n=WP.DOM.Create.tag,v=!b.hasSelectableDay(f,i),t=b,g,c;e.setHours(0,0,0,0);var d,r=function(a,c,b){var e=a.getMonth(),d=a.getDate(),f=a.getFullYear(),h=a.getDay();if(!$$WP.Utilities.IsNullOrEmpty(b)&&!c)if(b[e+1+"/"+d+"/"+f])return true;return false},o=function(b,d,i,k){var c=b.getMonth(),g=b.getDate(),h=b.getFullYear(),a="",j=b.getDay(),e;if(!$$WP.Utilities.IsNullOrEmpty(i)&&!d)if(i[c+1+"/"+g+"/"+h])a=" hasevents";if(b<k)a=a+" past";else if(c===f&&c===p&&g===s&&h===q)return"today"+a;a+=d?" othermonth":"";e=j===0||j===6;return t.filter(h,c,g)&&!d?(e?"wknd":"d")+a:(e?"wkndn":"n")+a},h,j;a=makeDate(i,f+1,1);h=a.getDay()-getFirstDayOfWeek();if(h<0)h+=7;a.setDate(a.getDate()-h);while(a.getMonth()!==f+1&&a.getFullYear()<=i){k=document.createElement("tr");for(j=0;j<7;j++){d=a.getMonth()!==f;var l=r(a,d,b.Dict,e);if(!d&&b.filter(i,f,a.getDate())){if(l){c=WP.DOM.Create.anchoredNode(b.formatCalendarDate(a),true,"");c.className="haseventfocus selectableevent"}else c=b.formatCalendarDate(a);if(!b.firstDate||b.firstDate==="")b.firstDate=a.getDate();if(!b.lastDate||b.lastDate<a.getDate())b.lastDate=a.getDate()}else c=document.createTextNode(d?"":a.getDate());g=n("td",o(a,d,b.Dict,e),d?"":"cal_"+a.getFullYear()+"_"+a.getMonth()+"_"+a.getDate());if(l)g.appendChild(c);else if(!$$WP.Utilities.IsNullOrEmpty(c)&&!d)dangerou$.setHtml(g,c);else g.appendChild(c);k.appendChild(g);a.setDate(a.getDate()+1)}m.appendChild(k)}return m.innerHTML}};Handlebars.registerHelper("$$WP$Components$Calendar$getCalendarObject",function(b){return new Handlebars.SafeString($$WP.Components.getInstance(b).getCalendarObject());var a=$$WP.Components.getInstance(b),c=a.getCalendarObject?a:a._calendar;return new Handlebars.SafeString(c.getCalendarObject())});$$WP.Components.Calendar.extend("Components.TemplateComponent")