/* Copyright 2017 Epic Systems Corporation. */

/*! Copyright (c) Epic Systems Corporation 2014-2016 */
$$WPComp.TimeoutWarningComponent=function WPComp$TimeoutWarningComponent(b){var e="@MYCHART@SecondsLeft@",a=this,d,c;$$WP.Strings.setDefaultNamespace("Global.TimeOutPopup");d=$$WP.HyperspaceSession?"FromHyperspace":WP.Events.showBeforeUnloadMessage()?"WithChanges":"";a.PreHtml=b.Html||b.Text||$$WP.Strings.get(d+"Message");a.Html=a.PreHtml;$$WPComp.applySettings(b,a);a._SecondsAtStart=Math.floor(a.SecondsLeft)||60;$$WP.Strings.addMnemonic(e,a._SecondsAtStart.toString());if($$WP.HyperspaceSession)c=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("FromHyperspaceStayButtonText"),null,"","stay")];else c=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("StayButtonText"),null,"","stay"),new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("LogOutButtonText"),null,"inlinedelete","leave")];a._clickContext=a._clickContext||a;a.TitleText=a.TitleText||$$WP.Strings.getForTemplate(d+"Title");a.ToolbarButtons=c;a.Components$Component({});$$WP.Strings.removeMnemonic(e);$$WP.Strings.clearDefaultNamespace();a._timer=$.proxy(a._timer,a);a._TimerId=window.setTimeout(a._timer,1e3);a._D0=new Date;a.addEventListener("click",a.clickTimeoutWarning);$$WPComp.TimeoutWarningComponent.hasVisibleInstance=true};$$WPComp.TimeoutWarningComponent.prototype={ToolbarButtons:null,SecondsLeft:60,_SecondsAtStart:Number,_D0:new Date,_TimerId:Number,IsClosable:true,Class:"timeoutwarning",clickTimeoutWarning:function WPComp$TimeoutWarningComponent$_click(a){if(!a.dataId)return;a.dataId===$$WPComp.TOOLBARIDENTIFIER+"leave"&&$$WPComp.TimeoutWarningComponent.leaveClick();this.dispose(true);return false},_timer:function WPComp$TimeoutWarningComponent$_timer(){var c="@MYCHART@SecondsLeft@",a=this,d,b;d=new Date;b=Math.floor(a._SecondsAtStart-Math.round((d-a._D0)/1e3,0));if(b<=0){$$WPComp.TimeoutWarningComponent.leaveClick();a.dispose(true)}else{a._timerId=window.setTimeout(a._timer,1e3);$$WP.Strings.setDefaultNamespace("Global.TimeOutPopup");$$WP.Strings.addMnemonic(c,b.toString());a.html(a.PreHtml);$$WP.Strings.removeMnemonic(c);$$WP.Strings.clearDefaultNamespace()}},dispose:function WPComp$TimeoutWarningComponent$dispose(b){var a=this;if(a._isDisposed)return;window.clearTimeout(a._timerId);a._timerId=null;a.Components$Component$dispose(b);$$WPUtil.setActivity();checkActivity();$$WP.Strings.getNamespace("Global.TimeOutPopup").removeMnemonic("@MYCHART@SecondsLeft@");$$WPComp.TimeoutWarningComponent.hasVisibleInstance=false}};$$WPComp.TimeoutWarningComponent.leaveClick=function WPComp$TimeoutWarningComponent$leaveClick(){WP.Events.cancelBeforeUnload();var a,b;a=new $$WPComp.LoggingOutComponent;b=new $$WPContain.Popup({positioningFunction:$$WPContain.Positions.InsideCentered,Components:a,Class:"logout"});b.show(true)};$$WPComp.TimeoutWarningComponent.extend("Components.Component")