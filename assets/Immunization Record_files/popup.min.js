/*! Copyright (c) Epic Systems Corporation 2014-2017 */
$$WPUtil.guaranteeExistence($$WP,"Popups");$$WPUtil.guaranteeExistence($$WP,"Utilities.UI");var $$WPPop=$$WP.Popups;$$WPContain.Popup=function WPContain$Popup(b){var a=this;$$WPComp.applySettings(b,a);switch(a.Size){case $$WPContain.Popup.SizeEnum.SMALL:a.Class+=" small";break;case $$WPContain.Popup.SizeEnum.MEDIUM:a.Class+=" medium";break;case $$WPContain.Popup.SizeEnum.LARGE:a.Class+=" large"}if(a.positioningFunction===null)a.positioningFunction=$$WPContain.Positions.InsideCentered;a.$parent=a.$parent&&a.$parent.length>0?a.$parent:$afe.jq(document.body);a.Containers$ContainerComponent({});a.addEventListener("resize",a._resizePopup);a.addEventListener("click",a._clickPopup);a.addEventListener("keydown",a._keydownPopup);if(a.HasBackButton!==false)if(a.HasBackButton||isDataTile()&&a.IsClosable&&a.Size!=$$WPContain.Popup.SizeEnum.SMALL){if(a.BackButtonText==="")a.BackButtonText=$$WP.Strings.get("PopupBackToPreviousPageButton",a.StringsNamespace);if(a.ToolbarButtons===null)a.ToolbarButtons=[];a.ToolbarButtons.push(new $$WPComp.ComplexObjects.Button(a.BackButtonText,null,"previouspage","close",a.BackButtonText))}};$$WPContain.Popup.SizeEnum={SMALL:1,MEDIUM:2,LARGE:3,AUTO:4};$$WPContain.Popup.__zIndex=0;$$WPContain.Popup.prototype={ToolbarButtons:null,HasOverlay:true,IsClosable:true,Class:"Popup",positioningFunction:$$WPContain.Positions.InsideCentered,Size:$$WPContain.Popup.SizeEnum.SMALL,_IsWindowScrollDisabled:false,_ScrollBarPosition:0,_IsScrollBarDisabledWhenOpened:false,_InitialBodyMarginTop:0,DontMatchColumnHeights:false,$parent:$afe.select("body"),HasBackButton:null,BackButtonText:"",show:function WPContain$Popup$show(b){var a=this;if(a._visible===true)return;a._ScrollBarPosition=$$WPUtil.getScrollTop();a._IsScrollBarDisabledWhenOpened=$afe.select("body").hasClass("scrollDisabled");if(a._IsScrollBarDisabledWhenOpened)a._InitialBodyMarginTop=$afe.select("body").css("margin-top");a.setAppropriateScrollBar();if(a.HasOverlay)a._overlay.on(!a.IsClosable,a);a.Containers$ContainerComponent$show(b);a.focus();a.setFocus();$afe.jq(window).on("resize","",a.ComponentNumber,a.__windowResize);a.setAppropriateContentHeight();if(isDataTile()&&a.Size!==$$WPContain.Popup.SizeEnum.SMALL)try{window.history.pushState(null,null,location.href);scrollTopOfTheIframe(0,true)}catch(c){$$WP.Debug.log("Cannot add Push state as the parent domain is not accessible")}},setAppropriateScrollBar:function WPContain$Popup$setAppropriateScrollBar(){var c="scrollDisabled",b=$afe.select("body"),a=$afe.jq(window),h=$afe.select("#header"),f,e,d;f=a.width();e=a.height();d=$$WPUtil.cssValueToPixels(b.css("min-width"));if(e>720&&f>=d&&!$$WP.Utilities.isBrowserCapableOf("touchEvents")&&!isDataTile()){this._IsWindowScrollDisabled=true;var g=$$WPUtil.getScrollTop();if(g>75)if(!h.hasClass("compact")){h.addClass("compact");a.trigger("compactHeader")}b.css({"margin-top":"-"+g+"px"}).addClass(c)}else b.css({"margin-top":""}).removeClass(c)},setAppropriateContentHeight:function WPContain$Popup$setAppropriateContentHeight(){var g="#content, #main, #sidebar",f="> .content",a=this,b,l=$afe.select("#header").outerHeight(),h,k,e,i,j,d,c;if(a._IsWindowScrollDisabled){h=$afe.jq(window).innerHeight();k=$afe.select(".Popup > .titlebar").outerHeight();b=h-2*l-20;e=a.$content.contentHeight();c=$$WPUtil.cssValueToPixels(a.$content.css("min-height"));if(typeof c!=="undefined"&&c>b)b=c;a.$container.find(f).css({"max-height":b+"px","overflow-y":"auto"})}else{a.$container.find(f).css({"max-height":"","overflow-y":"visible"});if(!a.DontMatchColumnHeights){$afe.select(g).css("height","");$afe.jq(window).trigger("matchColumnHeights");e=$afe.select("#content").height();i=a.$container.height();j=a.$container.offset().top;d=i+j+150;d>e&&$afe.select(g).css("height",d+"px")}}},setFocus:function(){var a=this;try{a.firstFocus=WP.DOM.Search.getNextFocusable(a.$content.get(0))}catch(b){}try{a.lastFocus=WP.DOM.Search.getLastFocusable(a.$container.get(0))}catch(c){}a.isFirstFocus=false},__windowResize:function(b){if(isDataTile())return;var a=$$WPComp.getInstance(b.data);a._IsWindowScrollDisabled=false;a.setAppropriateScrollBar();a.$container.trigger("resize")},hide:function WPContain$Popup$hide(b){var a=this;if(a._visible===false)return;a.Containers$ContainerComponent$hide(b);a._visible=false;if(!a._IsScrollBarDisabledWhenOpened)$afe.select("body").css({"margin-top":""}).removeClass("scrollDisabled");else $afe.select("body").css("margin-top",a._InitialBodyMarginTop);$afe.select("#content, #main, #sidebar").css("height","").removeClass("suppressed");$afe.jq(window).trigger("matchColumnHeights");a._IsWindowScrollDisabled=false;a.HasOverlay&&a._overlay.off(!a.IsClosable,a);try{a.FocusOnClose.focus()}catch(c){}a._ScrollBarPosition&&$$WPUtil.setScrollTop(a._ScrollBarPosition);$afe.jq(window).off("resize","",a.__windowResize)},reposition:function WPContain$Popup$reposition(c){var b="opacity",a=this;if(a.$container.parent().length===0)return;var d=a.$container.css(b);a.$container.css(b,0);try{a.positioningFunction({data:a},c)}catch(e){throw"repositioning error";}a.$container.css(b,d)},setTitle:function(f,a,g,d){var c="clearlabel",b=this,e;if(!f&&(!a||a.length===0)&&!d){e=true;a=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("JumpToContent","Global"),null,c,"jumptocontent")];b.$container.addClass("notitle")}else b.$container.removeClass("notitle");b.Containers$ContainerComponent$setTitle(f,a,g,d);e&&b.$title.addClass(c)},_resizePopup:function WPContain$Popup$_resize(){var a=this;if(!a.isVisible())return false;a.reposition(false);a.setAppropriateContentHeight();a.setFocus();return false},_clickPopup:function(a){if(a.dataId===$$WPComp.TITLEBARIDENTIFIER+"jumptocontent"){this.focus(true);return false}else if(a.dataId==="focusanchor")return false},_keydownPopup:function WPContain$Popup$_keydown(b){var c=false,a=this;b.keyCode===27&&a.IsClosable&&a.dispose(c);if(b.keyCode!==9)return;if(b.target!==a.firstFocus&&b.target!==a.lastFocus){if(a.isFirstFocus){var d=b.shiftKey?a.lastFocus:a.firstFocus;d&&d.focus();delete a.isFirstFocus;return c}return}if(b.shiftKey&&b.target===a.firstFocus){a.lastFocus&&a.lastFocus.focus();if(a.isFirstFocus)delete a.isFirstFocus;return c}if(!b.shiftKey&&b.target===a.lastFocus){a.firstFocus&&a.firstFocus.focus();if(a.isFirstFocus)delete a.isFirstFocus;return c}},_overlay:{on:function WPContain$Popup$overlay$on(d,a){var c,b;b=$afe.select("body");if(!b.length)b=$afe.select("#datatile");$$WPContain.Popup.__zIndex+=3;c=3e3+$$WPContain.Popup.__zIndex;a.$overlay=$afe.renderTemplate($$WP.Templates.overlay,{});b.safeAppend(a.$overlay);a.$overlay.show();a.$overlay.css("z-index",c);a.$container.css("z-index",c+1);$$WP.Utilities.UI.PDF&&$$WP.Utilities.UI.PDF.needIframeShim()&&$$WP.Utilities.UI.PDF.pageHasEmbeddedPdf()&&$$WP.Utilities.UI.PDF.hidePdfs();if(!d)a.$overlay.on("click","",a.ComponentNumber,a._overlay._overlayClick)},off:function WPContain$Popup$overlay$off(c,a){var b;!c&&a.$overlay.off("click","",a._overlay._overlayClick);a.$overlay.remove();b=$afe.select(".lb_overlay:visible").length;$$WP.Utilities.UI.PDF&&$$WP.Utilities.UI.PDF.needIframeShim()&&$$WP.Utilities.UI.PDF.pageHasEmbeddedPdf()&&b==0&&$$WP.Utilities.UI.PDF.showPdfs()},_overlayClick:function WPContain$Popup$overlay$overlayClick(b){var a=$$WPComp.getInstance(b.data);a&&a.dispose();return $$WPUtil.preventEvent(b)}}};$$WPContain.Popup.extend("Containers.ContainerComponent");$afe.jq(window).on("popupResize",function(){var a=$$WPComp.getInstance($afe.select(".Popup.component").safeAttr("data-component-id"));a!==null&&$$WPComp.isComponent(a)&&typeof a.setAppropriateContentHeight==="function"&&a.setAppropriateContentHeight()})